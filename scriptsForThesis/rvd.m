clc;clear;close all

%addpath ../../voronoi3D/

nt = 4;
nv = 4;
% xt = linspace(0,1,nt);
% xv = linspace(0,1,nv);
% [XT,YT] = meshgrid(xt,xt);
% [XV,YV] = meshgrid(xv,xv);
% t = unique([XT(:),YT(:)],'rows');
% v = unique([XV(:),YV(:)],'rows');
% t = t + 0.1*rand(nt^2,2);
% v = v + 0.1*rand(nv^2,2);
t =[0.0227    0.0686;...
    0.0684    0.4201;...
    0.0321    0.7247;...
    0.0749    1.0626;...
    0.4331    0.0111;...
    0.3603    0.3547;...
    0.4265    0.6703;...
    0.4030    1.0445;...
    0.6762    0.0327;....
    0.6913    0.3621;...
    0.7601    0.7163;...
    0.7146    1.0182;...
    1.0883    0.0934;...
    1.0779    0.4274;...
    1.0018    0.7258;...
    1.0771    1.0001];
% v(1:2:end-1,:) = v(1:2:end-1,:) + 0.3
% 
[x,y] = meshgrid([0:nv/2]*2*cos(pi/6),0:nv);
x = [x(:); x(:)+cos(pi/6)];
y = [y(:); y(:)+sin(pi/6)];
v = [x,y];
v = v/nv + 0.1*rand(size(v));

% v =[0.0972    0.0788;...
%     0.0746    0.3770;...
%     0.0200    0.7217;...
%     0.0036    1.0986;...
%     0.5962    0.0690;...
%     0.6351    0.4303;...
%     0.6402    0.6763;...
%     0.6138    1.0898;...
%     0.3523    0.1725;...
%     0.3778    0.5123;...
%     0.3140    0.8964;...
%     0.3173    1.2037;...
%     0.8786    0.1986;...
%     0.9189    0.5796;...
%     0.9481    0.8635;...
%     0.8960    1.2274];

Gt = triangleGrid(t);
Gv = triangleGrid(v);
Gp = pebi(Gv);
Gp = computeGeometry(Gp);
[~,c]  = min(sum(bsxfun(@minus, Gp.cells.centroids, [0.5,0.5]).^2,2));
cId = false(Gp.cells.num,1);
cId(c) = true;
%plotGrid(Gt,9,'faceColor','none','edgecolor','r')
hold on
plotGrid(Gp,~cId, 'faceColor','k','facealpha',0.1)
plotGrid(Gp, cId, 'faceColor','y','facealpha',0.1)
plot(v(:,1), v(:,2),'k.','markersize',6)
%plotGrid(Gv,'faceColor','none','linestyle',':')

axis equal off